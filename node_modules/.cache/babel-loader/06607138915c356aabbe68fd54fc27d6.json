{"ast":null,"code":"import _toConsumableArray from\"C:/Users/admin/Documents/Workspace/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/admin/Documents/Workspace/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from\"react\";import\"../scss/components/Contact.css\";import Contactcard from\"./Card/Contactcard\";import Photo from\"./Card/Photo\";import{useDispatch,useSelector}from\"react-redux\";import{getAllChatsAsync}from\"../redux/Slices/ChatSlice\";import{timeSince}from\"../../src/utils/changeDate\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Contact=function Contact(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),chats=_React$useState2[0],setChats=_React$useState2[1];var socket=useSelector(function(state){return state.socket.socket;});console.log(chats);var dispatch=useDispatch();useEffect(function(){dispatch(getAllChatsAsync()).then(function(res){setChats(res.payload.data.data.chats);});},[dispatch]);useEffect(function(){socket.on(\"receive_message\",function(data){var temp=chats.find(function(chat){chat._id==data.chatId;});if(temp){temp.latestMessage.content=data.content;temp.latestMessage.createdAt=data.createdAt;setChats(_toConsumableArray(chats));}console.log(chat);});},[socket]);var username=useSelector(function(state){return state.auth[0].user.name;});var chat=useSelector(function(state){return state.chat;});var allChats=useSelector(function(state){return state.chats.chats;});var allChatsElement=allChats===null||allChats===void 0?void 0:allChats.map(function(chat){var _chat$latestMessage,_chat$latestMessage2;return/*#__PURE__*/_jsx(Contactcard,{chatId:chat._id,name:username===chat.users[0].name?chat.users[1].name:chat.users[0].name,latestMessage:(_chat$latestMessage=chat.latestMessage)===null||_chat$latestMessage===void 0?void 0:_chat$latestMessage.content,time:timeSince(new Date((_chat$latestMessage2=chat.latestMessage)===null||_chat$latestMessage2===void 0?void 0:_chat$latestMessage2.createdAt))});});return/*#__PURE__*/_jsxs(\"div\",{className:\"contact-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contact-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contact-regular\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Regular Contact\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"contact-avatar\",children:[/*#__PURE__*/_jsx(Photo,{src:\"http://chiase24.com/wp-content/uploads/2022/02/tang-hap-hanh-anh-avatar-hai-haeac-nhan-la-ba_t-caea_i-1.jpg\"}),/*#__PURE__*/_jsx(Photo,{src:\"https://play-lh.googleusercontent.com/4qAz40o6M5w6hJ62VsjwGbYueB0fRWPmiG1yOZpNHn3qo2uzlhZZ1mwE5jtBlPp3Lw\"}),/*#__PURE__*/_jsx(Photo,{src:\"https://khoinguonsangtao.vn/wp-content/uploads/2022/07/avatar-gau-cute.jpg\"}),/*#__PURE__*/_jsx(Photo,{src:\"https://i.bloganchoi.com/bloganchoi.com/wp-content/uploads/2021/07/440d2bdf5e1e485b027e41fedaf33bbc-696x696.jpg?fit=700%2C20000&quality=95&ssl=1\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-content\",children:[/*#__PURE__*/_jsx(\"i\",{class:\"fa-solid fa-magnifying-glass\"}),/*#__PURE__*/_jsx(\"input\",{type:\"search\",placeholder:\"Enter a name\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"contact-message\",children:allChatsElement})]});};export default Contact;","map":{"version":3,"names":["React","useEffect","Contactcard","Photo","useDispatch","useSelector","getAllChatsAsync","timeSince","Contact","useState","chats","setChats","socket","state","console","log","dispatch","then","res","payload","data","on","temp","find","chat","_id","chatId","latestMessage","content","createdAt","username","auth","user","name","allChats","allChatsElement","map","users","Date"],"sources":["C:/Users/admin/Documents/Workspace/client/src/components/Contact.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport \"../scss/components/Contact.css\";\r\nimport Contactcard from \"./Card/Contactcard\";\r\nimport Photo from \"./Card/Photo\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getAllChatsAsync } from \"../redux/Slices/ChatSlice\";\r\nimport {timeSince} from \"../../src/utils/changeDate\"; \r\nconst Contact = () => {\r\n  const [chats, setChats] = React.useState([]);\r\n  const socket = useSelector((state) => state.socket.socket);\r\n  console.log(chats);\r\n  const dispatch = useDispatch();\r\n  useEffect(() => {\r\n    dispatch(getAllChatsAsync()).then((res) => {\r\n      setChats(res.payload.data.data.chats);\r\n    });\r\n  }, [dispatch]);\r\n  useEffect(() => {\r\n    socket.on(\"receive_message\", (data) => {\r\n      let temp = chats.find((chat) => { chat._id == data.chatId });\r\n      if (temp) {\r\n        temp.latestMessage.content = data.content;\r\n        temp.latestMessage.createdAt = data.createdAt;\r\n        setChats([...chats]);\r\n      }\r\n      console.log(chat);\r\n\r\n    });\r\n  }, [socket]);\r\n  const username = useSelector((state) => state.auth[0].user.name);\r\n  const chat = useSelector((state) => state.chat);  \r\n  const allChats = useSelector((state) => state.chats.chats);\r\n  const allChatsElement = allChats?.map((chat) => {\r\n    return (\r\n      <Contactcard\r\n        chatId={chat._id}\r\n        name={username===chat.users[0].name?chat.users[1].name:chat.users[0].name}\r\n        latestMessage={chat.latestMessage?.content}\r\n        time={timeSince(new Date (chat.latestMessage?.createdAt))}\r\n      />\r\n    );\r\n  });\r\n  \r\n  return (\r\n    <div className=\"contact-body\">\r\n      <div className=\"contact-content\">\r\n        <div className=\"contact-regular\">\r\n          <h1>Regular Contact</h1>\r\n          <div className=\"contact-avatar\">\r\n            <Photo src=\"http://chiase24.com/wp-content/uploads/2022/02/tang-hap-hanh-anh-avatar-hai-haeac-nhan-la-ba_t-caea_i-1.jpg\" />\r\n            <Photo src=\"https://play-lh.googleusercontent.com/4qAz40o6M5w6hJ62VsjwGbYueB0fRWPmiG1yOZpNHn3qo2uzlhZZ1mwE5jtBlPp3Lw\" />\r\n            <Photo src=\"https://khoinguonsangtao.vn/wp-content/uploads/2022/07/avatar-gau-cute.jpg\" />\r\n            <Photo src=\"https://i.bloganchoi.com/bloganchoi.com/wp-content/uploads/2021/07/440d2bdf5e1e485b027e41fedaf33bbc-696x696.jpg?fit=700%2C20000&quality=95&ssl=1\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"search\">\r\n          <div className=\"search-content\">\r\n            <i class=\"fa-solid fa-magnifying-glass\"></i>\r\n            <input type=\"search\" placeholder=\"Enter a name\"></input>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"contact-message\">\r\n        {allChatsElement}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Contact;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}